name: build-macos
on: [ push ]
jobs:
    build-executables:
        name: 'Build MacOS Executable'
        runs-on: macos-latest
        steps:
            -   name: 'Checkout'
                uses: actions/checkout@v3
            -   name: 'Setup Java 18'
                uses: actions/setup-java@v1
                with:
                    java-version: 18
            -   name: 'Build Executable'
                run: |
                    ./gradlew package
            -   name: 'Set Version Number'
                run: |
                    echo "VERSION=$(./gradlew properties -q | grep "version: " | awk '{print $2}')" >> $GITHUB_ENV
            -   name: 'Create MacOS Archive'
                run: |
                    zip -r StarMade-Launcher_MacOS.zip ./release-builds/macos
            -   name: 'Publish MacOS Executable'
                uses: actions/upload-artifact@v2-preview
                with:
                    name: StarMade-Launcher (MacOS)
                    path: StarMade-Launcher_MacOS.zip
            -   name: 'Upload Release Asset (MacOS)'
                uses: actions/upload-release-asset@v1
                env:
                    GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
                with:
                    upload_url: ${{ steps.create_release.outputs.upload_url }}
                    asset_path: StarMade-Launcher_MacOS.zip
                    asset_name: StarMade Launcher (MacOS)
                    asset_content_type: application/zip